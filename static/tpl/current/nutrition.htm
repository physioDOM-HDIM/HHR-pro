{% extends '../page.htm' %}

{% block title %}{{ 'Healthcare: current health status' | i18n }}{% endblock %}

{% block head %}
{% parent %}
<script src="/bower_components/form2js/src/form2js.js"></script>
<script src="/bower_components/momentjs/min/moment-with-locales.min.js"></script>
<script src="/scripts/utils.js"></script>
<script src="/scripts/modal.js"></script>

<link rel="import" href="/bower_components/zdk-modal/zdk-modal.html">
<link rel="import" href="/bower_components/zdk-panel/zdk-panel.html">

<link rel="stylesheet" href="../styles/current.css">
<style>
	div.assist { width: 250px; }
	input.assist { max-width: none; }
</style>
{% endblock %}

{% block content %}
<div id="content">
	<zdk-panel heading="{{ 'Nutritional status' | i18n }}">
		<form name="form" id="form" autocomplete="off" onsubmit="checkForm(); return false;">
			<fieldset>
				<legend>{{'Diet values'|i18n}}</legend>
				<div class="row value-row">
					<div flex class="value-name">{{'Size'|i18n}}</div>
					<input
						id="sizeInput"
						type="text"
						name="size"
						class="value-input"
						value="{{beneficiary.size}}"
						{% if status.validated %}disabled{% else %}readonly{% endif %} />
					<div class="value-unit">{{'meter'|i18n}}</div>
				</div>
				<div class="row value-row">
					<div flex class="value-name">{{'Weight'|i18n}}</div>
					<input
						id="weightInput"
						type="text"
						name="weight"
						class="value-input"
						value="{{status.weight}}" {% if status.validated %}disabled{% endif %} />
					<div class="value-unit">{{'kilogram'|i18n}}</div>
				</div>
				<div class="row value-row">
					<div flex class="value-name">{{'Lean/fat ratio'|i18n}}</div>
					<input type="text" name="lean" class="value-input" value="{{status.lean}}" {% if status.validated %}disabled{% endif %} />
					<div class="value-unit"></div>
				</div>
				<div class="row value-row">
					<div flex class="value-name">{{'BMI'|i18n}}</div>
					<input
						id="bmiInput"
						type="text"
						name="bmi"
						class="value-input"
						value="{{status.bmi}}" {% if status.validated %}disabled{% endif %} />
					<div class="value-unit"></div>
				</div>
				<div class="row value-row questionnaire-row" data-name="MNA">
					<div flex class="value-name">{{'MNA score'|i18n}}</div>
					<div class="questionnaire-date">{% if status.mnaDate %}{{status.mnaDate | date }}{% endif %}</div>
					<input type="text" class="questionnaire-score" value="{{status.mnaScore}}" readonly />
					<input type="hidden" class="questionnaire-answer" name="mnaAnswer" value="{{status.mnaAnswer}}" />
					<div class="questionnaire-button-container">
						<a class="button small blue" href={% if status.mnaAnswer %}"/answers/{{status.mnaAnswer}}"{% else %}"/questionnaire/MNA"{% endif %}>{{'Questionnaire'|i18n}}</a>
					</div>
				</div>
				<div class="row value-row questionnaire-row" data-name="MNA_MINI">
					<div flex class="value-name">{{'MNA SF score'|i18n}}</div>
					<div class="questionnaire-date">{% if status.mnaSfDate %}{{status.mnaSfDate | date }}{% endif %}</div>
					<input type="text" class="questionnaire-score" value="{{status.mnaSfScore}}" readonly />
					<input type="hidden" class="questionnaire-answer" name="mnaSfAnswer" value="{{status.mnaSfAnswer}}" />
					<div class="questionnaire-button-container">
						<a class="button small blue" href={% if status.mnaSfAnswer %}"/answers/{{status.mnaSfAnswer}}"{% else %}"/questionnaire/MNA_MINI"{% endif %}>{{'Questionnaire'|i18n}}</a>
					</div>
				</div>
				<div class="row value-row questionnaire-row" data-name="SNAQ">
					<div flex class="value-name">{{'SNAQ score' | i18n }}</div>
					<div class="questionnaire-date">{% if status.snaqDate %}{{status.snaqDate | date }}{% endif %}</div>
					<input type="text" class="questionnaire-score" value="{{status.snaqScore}}" readonly />
					<input type="hidden" class="questionnaire-answer" name="snaqAnswer" value="{{status.snaqAnswer}}" />
					<div class="questionnaire-button-container">
						<a class="button small blue" href={% if status.snaqAnswer %}"/answers/{{status.snaqAnswer}}"{% else %}"/questionnaire/SNAQ"{% endif %}>{{'Questionnaire'|i18n}}</a>
					</div>
				</div>
				<div class="row value-row questionnaire-row" data-name="DHD-FFQ">
					<div flex class="value-name">{{'Eetscore'|i18n}}</div>
					<div class="questionnaire-date">{% if status.dhdDate %}{{status.dhdDate | date }}{% endif %}</div>
					<input type="text" class="questionnaire-score" value="{{status.dhdScore}}" readonly />
					<input type="hidden" class="questionnaire-answer" name="dhdAnswer" value="{{status.dhdAnswer}}" />
					<div class="questionnaire-button-container">
						<a class="button small blue" href={% if status.dhdAnswer %}"/answers/{{status.dhdAnswer}}"{% else %}"/questionnaire/DHD-FFQ"{% endif %}>{{'Questionnaire'|i18n}}</a>
					</div>
				</div>
			</fieldset>

			<fieldset>
				<legend>{{'Special diet prescriptions'|i18n}}</legend>
				<div class="row value-row">
					<textarea flex name="dietPresc" {% if status.validated %}disabled{% endif %}>{{status.dietPresc}}</textarea>
				</div>
			</fieldset>

			<fieldset>
				<legend>{{'Assistance services'|i18n}}</legend>

				<div class="row value-row">
					<div class="value-name assist">{{'Delivery assistance'|i18n}}</div>
					<input type="checkbox" class="value-checkbox" />
					<input type="text" class="value-input assist" />
				</div>
			</fieldset>
			
			{% if rights.write %}
				{% if !status.validated %}
				<div id="buttons" class="row control">
					<span class="spacer"></span>
					<button type="button" class="blue" onclick="showConfirm();">{{'Validate'|i18n}}</button>
					<button type="button" class="red" onclick="location.reload();">{{'Cancel'|i18n}}</button>
					<button class="green">{{'Save'|i18n}}</button>
				</div>
				{% endif %}
			{% endif %}
		</form>
	</zdk-panel>
</div>

{% include "../modal.htm" %}

<zdk-modal id="confirmModal" closebutton="false">
	<div class="modalContainer">
		<div class="modalTitleContainer">{{'Confirmation' | i18n}}</div>
		<div class="modalContentContainer">{{'Are you sure?' |i18n}}</div>
		<div class="modalButtonContainer">
			<button class="red" onclick="hideConfirm();">{{'Cancel' | i18n}}</script>
			<button class="green" onclick="hideConfirm(); checkForm(true);">{{'Validate' | i18n}}</script>
		</div>
	</button>
</zdk-modal>

<script src="/scripts/questionnaireButton.js"></script>
<script src="/tpl/current/nutrition.js"></script>
{% endblock %}