{% extends '../page.htm' %}

{% block title %}{{ 'Activity/Motricity status' | i18n }}{% endblock %}

{% block head %}
{% parent %}
<script src="/bower_components/form2js/src/form2js.js"></script>
<script src="/bower_components/momentjs/min/moment-with-locales.min.js"></script>
<script src="/scripts/utils.js"></script>
<script src="/scripts/modal.js"></script>

<link rel="import" href="/bower_components/zdk-modal/zdk-modal.html">
<link rel="import" href="/bower_components/zdk-panel/zdk-panel.html">

<link rel="stylesheet" href="../styles/current.css">

{% endblock %}

{% block content %}
<div class="hidden" id="unsave">{{"You have unsaved data"|i18n}}</div>
<div class="hidden" id="changelang">{{"Are you sure to cancel your changes ?"|i18n}}</div>


<div class="hidden" id="validate-status">{{status.validated}}</div>

<div id="content">
	{% if status.validated && status.validatedDate %}
		<div class="validated-date right">
			{{ status.validatedDate | date }} {{"by"|i18n}} {{ author.name.family + ' ' + author.name.given }}
		</div>
	{% endif %}
	<form name="form" id="form" autocomplete="off" onsubmit="return false;">
		<zdk-panel heading="{{ 'Distance travelled' | i18n }}">

				<div class="row value-row">

					<div class="value-name">{{'Number of steps'|i18n}}</div>
					<div class="value-date stepsNumberDate">{% if status.stepsNumberDate %}{{status.stepsNumberDate}}{% endif %}</div>
					<input type="number" step="1" min="{{parameters.stepsNumber.range.min}}" max="{{parameters.stepsNumber.range.max}}" name="stepsNumber" class="value-input" value="{{status.stepsNumber}}" {% if !rights.write || !medical || !beneficiary.active %}disabled{% endif %} />
					<div class="value-unit">{{'steps per week'|i18n}}</div>

				</div>

				<div class="row value-row">

					<label class="comment-label" for="commentStepsNumber">{{'Status' | i18n}}</label>
					<input
						flex
						id="commentStepsNumber"
						class="comment-input to-disable"
						type="text"
						name="commentStepsNumber"
						value="{{status.commentStepsNumber}}"
						{% if !rights.write || !medical || !beneficiary.active %}disabled{% endif %}
						/>

				</div>

		</zdk-panel>

		{% if rights.write && medical && beneficiary.active %}
			{% if !status.validated %}
			<div id="buttons" class="row control">
				<span class="spacer"></span>
				<button type="submit" class="blue to-valid" onclick="showConfirm();">{{'Validate'|i18n}}</button>
				<button type="button" class="red" onclick="modified=false; location.reload();">{{'Cancel'|i18n}}</button>
				<button type="submit" class="green to-valid" onclick="checkForm();">{{'Save'|i18n}}</button>
			</div>
			{% endif %}
		{% endif %}

	</form>
</div>

{% include "../modal.htm" %}

<zdk-modal id="confirmModal" closebutton="false">
	<div class="modalContainer">
		<div class="modalTitleContainer">{{'Confirmation' | i18n}}</div>
		<div class="modalContentContainer">
			<p>{{'This action will lock all the datas entered. There is no going back to edit the datas.'|i18n}}<br>
			{{'Are you sure you want to continue ?' |i18n}}</p>
		</div>
		<div class="modalButtonContainer">
			<button class="red" onclick="hideConfirm();">{{'Cancel' | i18n}}</script>
			<button class="green" onclick="hideConfirm(); checkForm(true);">{{'Validate' | i18n}}</script>
		</div>
	</button>
</zdk-modal>

<script src="/scripts/questionnaireButton.js"></script>
<script src="/tpl/current/activity.js"></script>
{% endblock %}
