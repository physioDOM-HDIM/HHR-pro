<template is="auto-binding" id="formTpl">
	
	<form name="form" id="form-add-service" autocomplete="off" onsubmit="checkServiceForm(); return false;">
		<!--<input type="hidden" name="_id" value="{{beneficiary._id.toString()}}">-->
		<input type="hidden" name="serviceID" value="{{service._id}}">
		
		<div class="row h2">
			<div class="col">
				<label for="input-type">{{"Type of service" | i18n}}</label>
				<select id="input-type" name="type">
					{% raw %}
					<template repeat="{{ serviceRef in refServices}}">
						<template if="{{ service.ref === serviceRef.ref}}">
							<option value="{{ serviceRef.ref }}" checked>{{serviceRef.label.en}}</option>
						</template>
						<template if=" {{ service.ref !== serviceRef.ref}}">
							<option value="{{ serviceRef.ref }}">{{serviceRef.label.en}}</option>
						</template>
					</template>
					{% endraw %}
				</select>
			</div>
		</div>
		
		<div class="row h2">
			<div class="col">
				<label for="input-type">{{"Label of the service" | i18n}}</label>
				<input type="text" value="{%raw%}{{ service.label }}{%endraw%}" name="service.title">
			</div>
		</div>
		
		<div class="row h2">
			<div class="col">
				<label for="input-provider">{{"Provider" | i18n}}</label>
				<select id="input-provider" name="provider">
					{% raw %}
					<template repeat="{{ provider in providers}}">
						<template if="{{ provider._id === service.provide}}">
							<option value="{{ provider._id }}" checked>{provider.name.family}} {{provider.name.given}} (
								{{provider.job}} )
							</option>
						</template>
						<template if="{{ provider._id === service.provide}}">
							<option value="{{ provider._id }}">{provider.name.family}} {{provider.name.given}} (
								{{provider.job}} )
							</option>
						</template>
					</template>
					{% endraw %}
				</select>
			</div>
		</div>
		<div class="row" style="align-items: initial;">
			<label>{{"Detail of the service" | i18n}}</label>
			<textarea rows="5" cols="60" wrap="hard" name="detail">{%raw%}{{service.detail}}{%endraw%}</textarea>
		</div>
		
		<div class="row h2" id="dates-block">
			<label for="input-start">{{"Start date" | i18n}}</label>
			<zdk-input-date id="input-start" name="startDate" staticpos="true"
			                value="{%raw%}{{service.startDate}}{%endraw%}"></zdk-input-date>
			<label for="input-end" style="padding-left:5px">{{"End date" | i18n}}</label>
			<zdk-input-date id="input-end" name="endDate" staticpos="true"
			                value="{%raw%}{{service.endDate}}{%endraw%}"></zdk-input-date>
		</div>
		
		<div class="row h2" id="frequency">
			<label>{{"Frequency" | i18n}} ({%raw%}{{ service.frequency }}{%endraw%})</label>
			<input type="radio" name="frequency" 
			       value="monthly"
			       onclick = "frequencyChange(event)"
			       {%raw%}checked?="{{ service.frequency == 'monthly' }}"{%endraw%}> {{"Monthly" | i18n}}
			<input type="radio" name="frequency" 
			       value="weekly"
			       onclick = "frequencyChange(event)"
			       {%raw%}checked?="{{ service.frequency == 'weekly' }}"{%endraw%}> {{"Weekly" | i18n}}
			<input type="radio" name="frequency" 
			       value="daily"
			       onclick = "frequencyChange(event)"
			       {%raw%}checked?="{{ service.frequency == 'daily' }}"{%endraw%}> {{"Daily" | i18n}}
			<input type="radio" name="frequency" 
			       value="punctual" 
			       onclick = "frequencyChange(event)"
			       {%raw%}checked?="{{ service.frequency == 'punctual' }}"{%endraw%}> {{"Punctual" | i18n}}
		</div>
		
		<div id="special-inputs">
			<div class="row h2">
				<template if="{%raw%}{{ service.frequency == 'daily' }}{%endraw%}">
					<div id="repeat-group" class="col">
						<label for="input-repeat" style="width:auto">{{"Every" | i18n}}</label>
						<input type="number" id="input-repeat" name="repeat" value="1" style="width: 50px;margin:0px 5px">&nbsp;
						<span id="repeat-label">{% raw %}{{ service.frequency }}{% endraw %}</span>
					</div>
				</template>
				
				<div class="col" style="align-items: center;">
					<label for="input-duration" style="width:auto">{{"Duration" | i18n}}</label>
					{%raw%}
					<select id="input-duration" name="duration" style="min-width: 100px;margin: 0px 5px;">
						<option value="30"  selected?="{{ service.duration=='00:30' }}">00:30</option>
						<option value="60"  selected?="{{ service.duration=='01:00' }}">01:00</option>
						<option value="90"  selected?="{{ service.duration=='01:30' }}">01:30</option>
						<option value="120" selected?="{{ service.duration=='02:00' }}">02:00</option>
					</select>
					{%endraw%}
					<label style="width:auto">{{"hour(s)" | i18n}}</label>
				</div>
				
				<template if="{%raw%}{{ service.frequency == 'weekly' }}{%endraw%}">
					<button id="btn-cal-week" class="blue calendar-button" type="button" onclick="onBtnCalWeekClick()">
						<core-icon icon="today"></core-icon>
					</button>
				</template>
				
				<template if="{%raw%}{{ service.frequency == 'monthly' }}{%endraw%}">
					<button id="btn-cal-month" class="blue calendar-button" type="button" onclick="onBtnCalMonthClick()">
						<core-icon icon="today"></core-icon>
					</button>
				</template>
			</div>
		
			<template if="{%raw%}{{ service.frequency !== 'weekly' }}{%endraw%}">
				<div class="row h2">
					<label for="input-start-time">{{"Start at" | i18n}}</label>
					<select id="input-start-time" name="start-time">
						{% raw %}
						<template repeat="{{ hour in hours }}">
							<option value="{{hour}}" selected?="{{ service.time == hour }}">{{hour}}</option>
						</template>
						{% endraw %}
					</select>
				</div>
			</template>
			
			<template if="{%raw%}{{ service.frequency == 'monthly' }}{%endraw%}">
				<div id="days-month">
					<template repeat="{%raw%}{{ day in when }}{%endraw%}">
						<li class="day">{% raw %}{{day}}{% endraw %} {{" of the month" | i18n}}</li>
					</template>
				</div>
			</template>
			
			<template if="{%raw%}{{ service.frequency == 'weekly' }}{%endraw%}">
				<div id="days-week">
					<template repeat="{%raw%}{{ day in when }}{%endraw%}">
						<li class="day">{% raw %}{{day.day}}{% endraw %} {{"at" | i18n}} {% raw %} {{day.time}}{% endraw %}</li>
					</template>
				</div>
			</template>
		</div>
		
		<div class="row control">
			<span class="spacer"></span>
			<button type="button" class="red" onclick="cancelForm()">{{"Cancel"|i18n}}</button>
			<button class="green">{{"Save"|i18n}}</button>
		</div>
	</form>

</template>

<zdk-modal id="dialog-warning-frequency" closebutton="false">
	<div class="modalContainer">
		<div class="modalTitleContainer">{{"Warning"|i18n}}</div>
		<div class="modalContentContainer">
			<p>
				<strong>Nota:</strong> {{"Changing the frequency will delete all occurrences already programmed"|i18n}}
			</p>
		</div>
		<div class="modalButtonContainer">
			<button id="btn-warning-cancel" class="red">{{"Cancel"|i18n}}</button>
			<button id="btn-warning-confirm" class="blue">{{"Confirm"|i18n}}</button>
		</div>
	</div>
</zdk-modal>

<zdk-modal id="dialog-agenda" closebutton="false">
	<div class="modalContainer" fit>
		<div class="modalButtonContainer top">
			<button id="btn-cal-add" class="green">{{"Add"|i18n}}</button>
		</div>
		<div class="modalContentContainer" fit>
			<zdk-agenda id="agenda" lang="en-gb" hourHeight="40" hourShow="8" view="week" deleteButtons="true"
			            fit></zdk-agenda>
		</div>
		<div class="modalButtonContainer bottom">
			<button id="btn-cal-cancel" class="red">{{"Cancel"|i18n}}</button>
			<button id="btn-cal-confirm" class="blue">{{"Save"|i18n}}</button>
		</div>
	</div>

</zdk-modal>

<script>

</script>
<script src="/bower_components/momentjs/min/moment.min.js"></script>
<script src="/bower_components/momentjs/min/moment-with-locales.min.js"></script>
<!--<script src="/tpl/healthServiceCreate.js"></script>-->